var defaultReferrals = {
  enabled: false,
  // Active directory returns the following partitions as default referrals which we don't want to follow
  exclude: [
    'ldaps?://ForestDnsZones\\..*/.*',
    'ldaps?://DomainDnsZones\\..*/.*',
    'ldaps?://.*/CN=Configuration,.*'
  ]
};

module.exports = {
  defaultReferrals: defaultReferrals,
  /**
   * Checks to see if the specified referral or "chase" is allowed.
   * @param {String} referral The referral to inspect.
   * @returns {Boolean} True if the referral should be followed, false if otherwise.
   */
  isAllowedReferral: function isAllowedReferral(referral) {
    if (! defaultReferrals.enabled) return(false);
    if (! referral) return(false);

    return(! _.any(defaultReferrals.exclude, function(exclusion) {
      var re = new RegExp(exclusion, "i");
      return(re.test(referral));
    }));
  }
};
